/*! itwitter 2013-07-26 */
var regexpPw=function(a,b,c){c({value:b,valid:/^[a-zA-Z0-9_]{6,}$/.test(b)&&/[a-z]/i.test(b)&&/\d/.test(b),message:"密码不能小于6位且必须包含一个数字和字母"})};define("dist/js/sign",["lib/jquery","lib/jquery-plugins/bootstrap-tooltip","lib/jquery-plugins/jqBootstrapValidation"],function(a){function b(a,b,d,e){var f=c(a),g=d?{name:f.val()}:{email:f.val()};c.ajax({type:"POST",url:"/check_unique",data:g,beforeSend:function(){f.addClass("check_loading")},success:function(a){a?e||f.parent(".control-group").removeClass("warning").find(".help-block").html(""):f.parent(".control-group").addClass("warning").removeClass("success").find(".help-block").html('<ul role="alert"><li>'+b+"已存在</li></ul>")},complete:function(){f.removeClass("check_loading")}})}var c=a("lib/jquery");a("lib/jquery-plugins/bootstrap-tooltip"),a("lib/jquery-plugins/jqBootstrapValidation"),c(".logo").tooltip(),c("input,select,textarea").not("[type=submit],[name=passwordsignup_confirm],#usernamesignup").jqBootstrapValidation({validationMessage:{email:"这不是Email"}}),c("[name=passwordsignup_confirm]").jqBootstrapValidation({validationHandlers:["blur"]}),c("#register").submit(function(){""==c("[name=passwordsignup_confirm]").val()&&c("[name=passwordsignup_confirm]").parent(".control-group").addClass("error").find(".help-block").html('<ul role="alert"><li>请重复填写密码</li></ul>')}),c("[href=#toregister]").click(function(){c("#usernamesignup").focus(),c("#register input").attr("tabindex",1)}),c("[href=#tologin]").click(function(){c("#username").focus(),c("#register input").removeAttr("tabindex")}),c(function(){"#toregister"==location.hash?(c("#usernamesignup").focus(),c("#register input").attr("tabindex",1)):c("#username").focus()}),c("#login form").submit(function(a){a.preventDefault(),c.post("/login",{username:c("#username").val(),password:c("#password").val(),loginkeeping:c("#loginkeeping").prop("checked")?c("#loginkeeping").val():null},function(a){"err_id"==a?c("#username").parent(".control-group").addClass("error").find(".help-block").html('<ul role="alert"><li>用户名不存在</li></ul>'):"err_pw"==a?c("#password").parent(".control-group").addClass("error").find(".help-block").html('<ul role="alert"><li>密码错误</li></ul>'):a&&location.reload()})}),c("#emailsignup").blur(function(){b(this,"邮箱",!1,!0)}),c("#usernamesignup").on("keyup paste",function(){b(this,"用户名",!0)}).blur(function(){c(this).parent(".control-group").hasClass("warning")||c(this).parent(".control-group").addClass("success"),c(this).val().trim()||c(this).parent(".control-group").addClass("warning").removeClass("success").find(".help-block").html('<ul role="alert"><li>用户名不能为空白</li></ul>')})});